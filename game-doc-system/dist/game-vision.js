(()=>{"use strict";var e,t,o;!function(e){e.GameVision="game_vision",e.CoreGameConcept="core_game_concept",e.TargetAudience="target_audience",e.CorePillarsValues="core_pillars_values",e.WhyPlayIt="why_play_it",e.WhatShouldTheyFeel="what_should_they_feel",e.UniqueSellingPoints="unique_selling_points",e.GameLoop="game_loop",e.PlayerJourney="player_journey",e.StoryOverview="story_overview",e.Presentation="presentation",e.KeyQuestions="key_questions",e.CoreDesignDetails="core_design_details",e.StrategicDirection="strategic_direction"}(e||(e={})),function(e){e.NotStarted="not_started",e.InProgress="in_progress",e.Completed="completed"}(t||(t={})),function(e){e.GetProjects="get_projects",e.CreateProject="create_project",e.UpdateProject="update_project",e.DeleteProject="delete_project",e.GetProject="get_project",e.CreateDocument="create_document",e.UpdateDocument="update_document",e.GetDocument="get_document",e.DeleteDocument="delete_document",e.StartDocumentCreation="start_document_creation"}(o||(o={}));const n={id:"default_game_vision",type:e.GameVision,name:"Game Vision",description:"Capture the creative essence and high-level concept of your game",version:"1.0.0",isCustom:!1,lastModified:Date.now(),settings:{purpose:"Capture the creative essence and high-level concept of your game in a clear, inspiring format.",keyInformation:["Game type and core gameplay","Unique features and innovations","Emotional impact on players","Core promise to players"],outputFormat:{sections:["Title of the game","Single inspirational line description","One comprehensive paragraph containing the game overview"],requirements:["Game type, player count, and platform","Core gameplay and player fantasy","Main gameplay experience","Player motivation and rewards","Unique elements and lasting impact"]}}};class r{static async getTemplate(e){try{return(await this.getAllTemplates())[e]||this.DEFAULT_TEMPLATES[e]}catch(t){return console.error("Error getting template:",t),this.DEFAULT_TEMPLATES[e]}}static async getAllTemplates(){try{return(await chrome.storage.sync.get(this.STORAGE_KEY))[this.STORAGE_KEY]||this.DEFAULT_TEMPLATES}catch(e){return console.error("Error getting templates:",e),this.DEFAULT_TEMPLATES}}static async saveTemplate(e,t){try{const o=await this.getAllTemplates(),n=o[e]||this.DEFAULT_TEMPLATES[e];if(!n)throw new Error(`No template found for type: ${e}`);const r={...n,settings:t,lastModified:Date.now(),isCustom:!0};await chrome.storage.sync.set({[this.STORAGE_KEY]:{...o,[e]:r}})}catch(e){throw console.error("Error saving template:",e),e}}static async resetTemplate(e){try{const t=await this.getAllTemplates(),o=this.DEFAULT_TEMPLATES[e];if(!o)throw new Error(`No default template found for type: ${e}`);await chrome.storage.sync.set({[this.STORAGE_KEY]:{...t,[e]:o}})}catch(e){throw console.error("Error resetting template:",e),e}}static async exportTemplate(e){try{const t=await this.getTemplate(e);return JSON.stringify(t,null,2)}catch(e){throw console.error("Error exporting template:",e),e}}static async importTemplate(e){try{const t=JSON.parse(e);if(!t.type||!t.settings)throw new Error("Invalid template format");await this.saveTemplate(t.type,t.settings)}catch(e){throw console.error("Error importing template:",e),e}}}r.STORAGE_KEY="gdds_templates",r.DEFAULT_TEMPLATES={[e.GameVision]:n},document.addEventListener("DOMContentLoaded",(async()=>{const t=document.querySelector(".message-input"),o=document.querySelector(".main-content"),n=document.querySelector(".add-document-btn"),a=document.querySelector('.document-controls button[title="Download"]'),s=document.querySelector('.document-controls button[title="Settings"]'),i=document.getElementById("templateSettings"),c=document.getElementById("closeModal"),l=document.getElementById("saveChanges"),m=document.getElementById("cancelChanges");if(!t||!o||!i)return void console.error("Required elements not found");let u=null;async function p(){try{u=await r.getTemplate(e.GameVision);const t=document.querySelector('[data-section="purpose"] .template-section-content');t&&(t.textContent=u.settings.purpose);const o=document.querySelector('[data-section="keyInformation"] .bullet-list');o&&(o.innerHTML=u.settings.keyInformation.map((e=>`<li>${e}</li>`)).join(""));const n=document.querySelector('[data-section="outputFormat"] .bullet-list');n&&(n.innerHTML=`\n                    ${u.settings.outputFormat.sections.map((e=>`<li>${e}</li>`)).join("")}\n                    <li>One comprehensive paragraph containing:\n                        <ul class="sub-bullet-list">\n                            ${u.settings.outputFormat.requirements.map((e=>`<li>${e}</li>`)).join("")}\n                        </ul>\n                    </li>\n                `)}catch(e){console.error("Error loading template settings:",e)}}function d(e,t){if(!o)return;const n=document.createElement("div");n.className=`chat-message ${t}-message`,n.textContent=e,o.appendChild(n),n.scrollIntoView({behavior:"smooth"})}s?.addEventListener("click",(()=>{p(),i.style.display="flex"})),c?.addEventListener("click",(()=>{i.style.display="none"})),m?.addEventListener("click",(()=>{i.style.display="none"})),l?.addEventListener("click",(async()=>{try{const t=document.querySelector('[data-section="purpose"] .template-section-content'),o=document.querySelectorAll('[data-section="keyInformation"] .bullet-list > li'),n=document.querySelectorAll('[data-section="outputFormat"] .bullet-list > li:not(:last-child)'),a=document.querySelectorAll('[data-section="outputFormat"] .sub-bullet-list > li');if(!t)throw new Error("Purpose content not found");const s=t.textContent||"",c=Array.from(o).map((e=>e.textContent||"")),l=Array.from(n).map((e=>e.textContent||"")),m=Array.from(a).map((e=>e.textContent||""));await r.saveTemplate(e.GameVision,{purpose:s,keyInformation:c,outputFormat:{sections:l,requirements:m}}),i.style.display="none"}catch(e){console.error("Error saving template settings:",e)}})),t.addEventListener("keypress",(async n=>{if("Enter"===n.key&&!n.shiftKey){n.preventDefault();const a=t.value.trim();if(a)try{d(a,"user"),t.value="";const n=function(){if(!o)throw new Error("Main content not found");const e=document.createElement("div");return e.className="chat-message typing-indicator",e.innerHTML="<span>AI is typing</span>",o.appendChild(e),e.scrollIntoView({behavior:"smooth"}),e}(),s=await r.getTemplate(e.GameVision);chrome.runtime.sendMessage({type:"process_message",payload:{message:a,documentType:"game_vision",template:s.settings}},(e=>{n.remove(),e&&e.success?d(e.data,"assistant"):d("Sorry, there was an error processing your message.","error")}))}catch(e){console.error("Error processing message:",e),d("Sorry, there was an error processing your message.","error")}}})),n?.addEventListener("click",(()=>{chrome.runtime.sendMessage({type:"show_template_selection"})})),a?.addEventListener("click",(async()=>{try{const e=Array.from(o.querySelectorAll(".chat-message")).map((e=>e.textContent?.trim()||"")).join("\n\n"),t=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="game-vision-document.txt",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}catch(e){console.error("Error downloading document:",e),d("Error downloading document","error")}})),p()}))})();
//# sourceMappingURL=game-vision.js.map